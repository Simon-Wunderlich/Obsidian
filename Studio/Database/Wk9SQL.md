Created: May 28 2025
Class: [[Advanced SQL]] 
- - -
## Part A
``` sql
SELECT DIRECTOR.DIRNAME, SUM(AWRD) FROM
MOVIE
JOIN DIRECTOR ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB
GROUP BY DIRECTOR.DIRNAME;

Q. 2
SELECT DIRECTOR.DIRNAME, SUM(AWRD) FROM
MOVIE
JOIN DIRECTOR ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB
GROUP BY DIRECTOR.DIRNAME
ORDER BY SUM(AWRD) DESC;

Q. 3
SELECT DIRECTOR.DIRNAME, SUM(AWRD) as awards FROM
DIRECTOR
LEFT OUTER JOIN MOVIE ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB
GROUP BY DIRECTOR.DIRNAME
ORDER BY awards DESC;

Q. 4
SELECT DIRECTOR.DIRNAME, SUM(AWRD) as awards FROM
DIRECTOR
JOIN MOVIE ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB
GROUP BY DIRECTOR.DIRNAME
UNION
SELECT DIRNAME, 0 as awards FROM
DIRECTOR
LEFT OUTER JOIN MOVIE ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB
WHERE MOVIE.MVTITLE IS NULL
ORDER BY awards DESC;

Q. 5
SELECT DIRECTOR.DIRNAME, SUM(AWRD) as awards, SUM(NOMS) FROM
DIRECTOR
JOIN MOVIE ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB
GROUP BY DIRECTOR.DIRNAME
HAVING SUM(MOVIE.NOMS) > (SELECT AVG(nms) FROM (SELECT SUM(NOMS) as nms FROM DIRECTOR
JOIN MOVIE ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB
GROUP BY DIRECTOR.DIRNAME));

Q. 6
SELECT * FROM
MEMBER
GROUP BY mmbname
HAVING COUNT(*) > 1;

Q. 7
SELECT * FROM MOVIE
EXCEPT
SELECT * FROM MOVIE
WHERE MPAA = 'R'

Q. 8
SELECT MVTITLE FROM MOVIE
WHERE DIRNUMB = 1
INTERSECT
SELECT MVTITLE FROM MOVIE
JOIN MOVSTAR ON MOVIE.MVNUMB = MOVSTAR.MVNUMB
WHERE MOVSTAR.STARNUMB = 1;

Q. 9
SELECT MVTITLE FROM MOVIE
WHERE DIRNUMB = 1
EXCEPT
SELECT MVTITLE FROM MOVIE
JOIN MOVSTAR ON MOVIE.MVNUMB = MOVSTAR.MVNUMB
WHERE MOVSTAR.STARNUMB = 1;
```

## Part B
