Created: May 21 2025
Class: [[JOIN]] 
- - -
### Part A
``` sql
Q. 1
SELECT m.MVTITLE AS Title, d.DIRNAME AS Director
FROM MOVIE as m
JOIN DIRECTOR AS d ON m.DIRNUMB = d.DIRNUMB;

Q. 2
SELECT m.MVTITLE AS Title, d.DIRNAME AS Director
FROM MOVIE as m
NATURAL JOIN DIRECTOR as d;

Q. 3
SELECT m.MVTITLE AS Title, d.DIRNAME AS Director
FROM MOVIE as m
NATURAL JOIN DIRECTOR as d
WHERE Director = 'Allen, Woody';

Q. 4 
SELECT m.MVTITLE AS Title, d.DIRNAME AS Director
FROM MOVIE as m
NATURAL JOIN DIRECTOR as d
WHERE d.DIRDIED is NULL;

Q. 5
SELECT m.MVTITLE, s.STARNAME
FROM MovStar As ms
JOIN MOVIE as m ON ms.MVNUMB = m.MVNUMB
JOIN STAR as s ON s.STARNUMB = ms.STARNUMB
WHERE m.MVTITLE = 'Manhattan';

Q. 6
SELECT m.MVTITLE, d.DIRNAME, s.STARNAME
FROM MOVIE as m
JOIN DIRECTOR as d ON d.DIRNUMB = m.DIRNUMB
JOIN MOVSTAR AS ms ON ms.MVNUMB = m.MVNUMB
JOIN STAR as s ON s.STARNAME = d.DIRNAME AND s.STARNUMB = ms.STARNUMB;

Q. 7
SELECT d.DIRNAME, m.MVTITLE
FROM DIRECTOR as d
LEFT OUTER JOIN MOVIE as m ON m.DIRNUMB = d.DIRNUMB;

Q. 8
SELECT DISTINCT ss.STARNAME
FROM STAR as s
JOIN MOVSTAR as ms ON ms.STARNUMB = s.STARNUMB AND s.STARNAME = 'Allen, Woody'
JOIN MOVSTAR as mms ON mms.MVNUMB = ms.MVNUMB AND mms.STARNUMB != ms.STARNUMB
JOIN STAR as ss ON ss.STARNUMB = mms.STARNUMB;
```

### Part B
``` sql
Q. 9 
SELECT DISTINCT STAR.STARNAME FROM STAR
JOIN MOVSTAR ON MOVSTAR.STARNUMB = STAR.STARNUMB
WHERE MOVSTAR.MVNUMB IN (SELECT ms.MVNUMB
FROM STAR as s
JOIN MOVSTAR as ms ON ms.STARNUMB = s.STARNUMB AND s.STARNAME = 'Allen, Woody') AND STAR.STARNAME != 'Allen, Woody';

Q. 10
SELECT DISTINCT STARNAME
FROM MOVSTAR
JOIN STAR ON STAR.STARNUMB = MOVSTAR.STARNUMB
WHERE EXISTS
(
SELECT STARNAME
FROM MOVSTAR as ms
WHERE MOVSTAR.MVNUMB = ms.MVNUMB AND ms.STARNUMB =1
) AND STARNAME != 'Allen, Woody';

Q. 11
SELECT MVTITLE, YRMDE
FROM MOVIE
WHERE YRMDE IN (
	SELECT MAX(YRMDE) FROM MOVIE
);

Q. 12
SELECT MVTITLE
FROM MOVIE
JOIN DIRECTOR ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB AND DIRECTOR.DIRNAME = 'Hitchcock, Alfred'
WHERE MVTITLE NOT IN (
	SELECT MVTITLE FROM
	MOVIE
	JOIN BORROW ON BORROW.MVNUMB = MOVIE.MVNUMB
	JOIN MEMBER ON MEMBER.MMBNUMB = BORROW.MMBNUMB
	WHERE MEMBER.MMBNAME = 'Tran, Thanh'
);

Q. 13
SELECT MVTITLE
FROM MOVIE
JOIN DIRECTOR ON MOVIE.DIRNUMB = DIRECTOR.DIRNUMB AND DIRECTOR.DIRNAME = 'Hitchcock, Alfred'
WHERE NOT EXISTS (
	SELECT MVTITLE
	FROM BORROW
	JOIN MEMBER ON MEMBER.MMBNUMB = BORROW.MMBNUMB
	WHERE MEMBER.MMBNAME = 'Tran, Thanh' AND BORROW.MVNUMB = MOVIE.MVNUMB
);

Q. 14
SELECT MVTITLE, AWRD FROM MOVIE
WHERE AWRD IN
(
	SELECT MAX(AWRD) FROM MOVIE
);
```
